<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        
        <!-- Module Category -->
        <record id="module_category_stock_market" model="ir.module.category">
            <field name="name">Stock Market Trading</field>
            <field name="description">Stock Market Trading Simulator</field>
            <field name="sequence">50</field>
        </record>
        
        <!-- Security Groups -->
        <record id="group_stock_investor" model="res.groups">
            <field name="name">Investor</field>
            <field name="category_id" ref="module_category_stock_market"/>
            <field name="implied_ids" eval="[(4, ref('base.group_portal'))]"/>
            <field name="comment">Investors can place orders and view their portfolio</field>
        </record>
        
        <record id="group_stock_broker" model="res.groups">
            <field name="name">Broker</field>
            <field name="category_id" ref="module_category_stock_market"/>
            <field name="implied_ids" eval="[(4, ref('base.group_portal'))]"/>
            <field name="comment">Brokers can view client orders and earn commissions</field>
        </record>
        
        <record id="group_stock_banker" model="res.groups">
            <field name="name">Banker</field>
            <field name="category_id" ref="module_category_stock_market"/>
            <field name="implied_ids" eval="[(4, ref('base.group_portal'))]"/>
            <field name="comment">Bankers can manage deposits and loans</field>
        </record>
        
        <record id="group_stock_admin" model="res.groups">
            <field name="name">Stock Market Administrator</field>
            <field name="category_id" ref="module_category_stock_market"/>
            <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
            <field name="comment">Full access to stock market configuration and operations</field>
        </record>
        
        <!-- Record Rules -->
        
        <!-- Investor Rules -->
        <record id="stock_order_investor_rule" model="ir.rule">
            <field name="name">Investor: Own Orders Only</field>
            <field name="model_id" ref="model_stock_order"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_stock_investor'))]"/>
        </record>
        
        <record id="stock_position_investor_rule" model="ir.rule">
            <field name="name">Investor: Own Positions Only</field>
            <field name="model_id" ref="model_stock_position"/>
            <field name="domain_force">[('user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_stock_investor'))]"/>
        </record>
        
        <record id="stock_trade_investor_rule" model="ir.rule">
            <field name="name">Investor: Own Trades Only</field>
            <field name="model_id" ref="model_stock_trade"/>
            <field name="domain_force">['|', ('buy_order_id.user_id', '=', user.id), ('sell_order_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_stock_investor'))]"/>
        </record>
        
        <!-- Broker Rules -->
        <record id="stock_order_broker_rule" model="ir.rule">
            <field name="name">Broker: Client Orders</field>
            <field name="model_id" ref="model_stock_order"/>
            <field name="domain_force">[('user_id.broker_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_stock_broker'))]"/>
        </record>
        
        <record id="stock_trade_broker_rule" model="ir.rule">
            <field name="name">Broker: Client Trades</field>
            <field name="model_id" ref="model_stock_trade"/>
            <field name="domain_force">['|', ('buy_order_id.user_id.broker_id', '=', user.id), ('sell_order_id.user_id.broker_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_stock_broker'))]"/>
        </record>
        
        <!-- Banker Rules -->
        <record id="stock_deposit_banker_rule" model="ir.rule">
            <field name="name">Banker: All Deposits</field>
            <field name="model_id" ref="model_stock_deposit"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_stock_banker'))]"/>
        </record>
        
        <record id="stock_loan_banker_rule" model="ir.rule">
            <field name="name">Banker: All Loans</field>
            <field name="model_id" ref="model_stock_loan"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_stock_banker'))]"/>
        </record>
        
        <!-- Admin has full access - no domain restrictions -->
        <record id="stock_admin_all_rule" model="ir.rule">
            <field name="name">Admin: Full Access</field>
            <field name="model_id" ref="model_stock_order"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_stock_admin'))]"/>
        </record>
        
    </data>
</odoo> 